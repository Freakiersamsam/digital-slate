const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jspdf.es.min-DHdgeTbP.js","assets/index-wdOrGvgq.js","assets/index-CU_Bohoc.css"])))=>i.map(i=>d[i]);
import{_ as K}from"./index-wdOrGvgq.js";async function et({notes:y,slateInfo:a,sessionStart:B,filename:k="digital-slate-session.pdf"}){console.log("[DEBUG] exportSessionPDF called",{notes:y,slateInfo:a,sessionStart:B,filename:k});try{let Z=function(e,n,d){if(!n)return[""];e.setFont("helvetica","normal"),e.setFontSize(8);const i=[],c=n.toString().split(/\r?\n/);for(const h of c){if(h.trim()===""){i.push("");continue}let x=h.split(/(\s+)/),r="";for(let m=0;m<x.length;m++){let o=x[m];if(/^\s+$/.test(o)){r+=o;continue}if(e.getTextWidth(r+o)<=d)r+=o;else if(e.getTextWidth(o)>d){r.trim()!==""&&(i.push(r.trimEnd()),r="");let l="";for(let f=0;f<o.length;f++){let S=l+o[f];e.getTextWidth(S+"-")>d?l.length>0?(i.push(l+"-"),l=o[f]):(i.push(o[f]),l=""):l=S}l.length>0&&(r=l)}else r.trim()!==""&&i.push(r.trimEnd()),r=o}r.trim()!==""&&i.push(r.trimEnd())}return i.length>0?i:[""]},j=function(e,n,d){if(!n)return[""];e.setFont("helvetica","normal"),e.setFontSize(8);const i=[],c=n.toString().split(/\r?\n/);for(const h of c){if(h.trim()===""){i.push("");continue}let x=h.match(/\S+|\s+/g)||[],r="";for(let m=0;m<x.length;m++){let o=x[m];if(e.getTextWidth(r+o)<=d)r+=o;else if(!/^\s+$/.test(o)&&e.getTextWidth(o)>d){r.trim()!==""&&(i.push(r.trimEnd()),r="");let l="";for(let f=0;f<o.length;f++){let S=l+o[f];e.getTextWidth(S+"-")>d?l.length>0?(i.push(l+"-"),l=o[f]):(i.push(o[f]),l=""):l=S}l.length>0&&(r=l)}else r.trim()!==""&&i.push(r.trimEnd()),r=o}r.trim()!==""&&i.push(r.trimEnd())}return i.length>0?i:[""]};if(!y||y.length===0){alert("No notes to export!");return}const{jsPDF:E}=await K(async()=>{const{jsPDF:e}=await import("./jspdf.es.min-DHdgeTbP.js").then(n=>n.j);return{jsPDF:e}},__vite__mapDeps([0,1,2])),t=new E({orientation:"portrait",unit:"mm",format:"a4",compress:!0}),g={primary:"#3a3a3a",secondary:"#6a6a6a",accent:"#e67e22",background:"#f7f5f3",cardBg:"#faf8f6",border:"#e8e4e0",text:{primary:"#4a4a4a",secondary:"#7a7a7a",light:"#999999"}},u=e=>{const n=e.replace("#",""),d=parseInt(n.substr(0,2),16),i=parseInt(n.substr(2,2),16),c=parseInt(n.substr(4,2),16);return[d,i,c]},C=(e,n,d=!0)=>{if(!e)return"";let i=e.toString();if(t.getTextWidth(i)<=n)return i;const c=d?"...":"";for(;t.getTextWidth(i+c)>n&&i.length>0;)i=i.slice(0,-1);return i+c},Q=(e,n)=>{if(!e)return[""];const d=e.toString(),i=d.split(/\r?\n/);let c=[];return t.setFont("helvetica","normal"),t.setFontSize(8),i.forEach(h=>{if(h.trim()===""){c.push("");return}let x="",r=0;for(;r<h.length;){let m=x+h[r];if(t.getTextWidth(m)<=n)x=m,r++;else if(x.trim()!=="")c.push(x.trimEnd()),x="";else{let o="";for(;r<h.length&&t.getTextWidth(o+h[r]+"-")<=n;)o+=h[r],r++;o.length>0?(c.push(o+(r<h.length?"-":"")),o=""):(c.push(h[r]),r++)}}x.trim()!==""&&c.push(x.trimEnd())}),console.log("[DEBUG] wrapTextInColumn output",{input:d,lines:c}),c.length>0?c:[""]},s=20,D=210,b=D-s*2,H=30;t.setFillColor(255,255,255),t.rect(0,0,D,H,"F"),t.setTextColor(...u(g.primary)),t.setFontSize(20),t.setFont("helvetica","bold"),t.text("Digital Slate",s,18),t.setFontSize(10),t.setFont("helvetica","normal"),t.setTextColor(...u(g.text.secondary));const M=`Exported ${new Date().toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})}`;t.text(M,D-s,18,{align:"right"});const v=H+10,L=45;t.setFillColor(...u(g.border)),t.roundedRect(s+1,v+1,b,L,3,3,"F"),t.setFillColor(...u(g.cardBg)),t.roundedRect(s,v,b,L,3,3,"F"),t.setDrawColor(...u(g.border)),t.setLineWidth(.5),t.roundedRect(s,v,b,L,3,3,"S"),t.setTextColor(...u(g.text.primary)),t.setFontSize(12),t.setFont("helvetica","bold"),t.text("Session Overview",s+8,v+10),t.setFontSize(8),t.setFont("helvetica","normal");const _=s+8,Y=s+b/2+8,$=22,G=b/2-30,X=[{label:"Production:",value:(a==null?void 0:a.prod)||"Not specified"},{label:"Director:",value:(a==null?void 0:a.director)||"Not specified"},{label:"DOP:",value:(a==null?void 0:a.dop)||"Not specified"},{label:"Camera:",value:(a==null?void 0:a.camera)||"Not specified"}],A=[{label:"Started:",value:new Date(B).toLocaleString()},{label:"Roll:",value:(a==null?void 0:a.roll)||"Not specified"},{label:"Total Notes:",value:y.length.toString()},{label:"Location:",value:(a==null?void 0:a.location)||"Not specified"}];let z=v+18,R=v+18;X.forEach(e=>{t.setFont("helvetica","bold"),t.setTextColor(...u(g.text.secondary)),t.text(e.label,_,z),t.setFont("helvetica","normal"),t.setTextColor(...u(g.text.primary));const n=C(e.value,G);t.text(n,_+$,z),z+=7}),A.forEach(e=>{t.setFont("helvetica","bold"),t.setTextColor(...u(g.text.secondary)),t.text(e.label,Y,R),t.setFont("helvetica","normal"),t.setTextColor(...u(g.text.primary));const n=C(e.value,G);t.text(n,Y+$,R),R+=7});const N=v+L+20,P=14;t.setFillColor(...u(g.primary)),t.roundedRect(s,N,b,P,2,2,"F");const p=[{title:"Timecode",x:s+2,width:28,align:"left"},{title:"Relative",x:s+32,width:24,align:"left"},{title:"Scene",x:s+58,width:16,align:"center"},{title:"Take",x:s+76,width:16,align:"left"},{title:"Notes",x:s+94,width:94,align:"left"}];t.setTextColor(255,255,255),t.setFontSize(10),t.setFont("helvetica","bold"),p.forEach(e=>{e.align==="center"?t.text(e.title,e.x+e.width/2,N+9,{align:"center"}):t.text(e.title,e.x+2,N+9)});let T=N+P+2;t.setFont("helvetica","normal"),t.setFontSize(8),y.forEach((e,n)=>{var O,V;let d="";if(e.slateInfo&&e.slateInfo.takeStart!=null&&e.timecodeIn!=null){let F=typeof e.timecodeIn=="number"?e.timecodeIn:parseFloat(e.timecodeIn),w=typeof e.slateInfo.takeStart=="number"?e.slateInfo.takeStart:parseFloat(e.slateInfo.takeStart);if(!isNaN(F)&&!isNaN(w)&&F>=w){let W=F-w,q=Math.floor(W/60),J=(W%60).toFixed(3);d=`${q}:${J.padStart(6,"0")}`}}const i=C(e.timecodeIn||"-",p[0].width-4),c=C(d,p[1].width-4),h=C(((O=e.slateInfo)==null?void 0:O.scene)||"-",p[2].width-4),x=C(((V=e.slateInfo)==null?void 0:V.take)||"-",p[3].width-4),r=j(t,e.content||"",p[4].width-8),m=4,l=Math.max(10,r.length*m+6);T+l>260&&(t.addPage(),T=30,t.setFillColor(...u(g.primary)),t.roundedRect(s,T-P,b,P,2,2,"F"),t.setTextColor(255,255,255),t.setFontSize(10),t.setFont("helvetica","bold"),p.forEach(F=>{F.align==="center"?t.text(F.title,F.x+F.width/2,T-5,{align:"center"}):t.text(F.title,F.x+2,T-5)}),T+=2,t.setFont("helvetica","normal"),t.setFontSize(8)),n%2===0&&(t.setFillColor(...u(g.background)),t.rect(s,T-1,b,l,"F")),t.setTextColor(...u(g.text.primary));const S=T+l/2+1;if(t.text(i,p[0].x+2,S),t.text(c,p[1].x+2,S),h&&h!=="-"?t.text(h,p[2].x+p[2].width/2,S,{align:"center"}):t.text("-",p[2].x+p[2].width/2,S,{align:"center"}),t.text(x,p[3].x+2,S),r.length>0){const F=T+(l-r.length*m)/2+3;r.forEach((w,W)=>{w&&w.toString().trim()&&t.text(w,p[4].x+3,F+W*m)})}T+=l});const U=t.internal.getNumberOfPages();for(let e=1;e<=U;e++)t.setPage(e),t.setDrawColor(...u(g.border)),t.setLineWidth(.5),t.line(s,285,D-s,285),t.setFontSize(8),t.setTextColor(...u(g.text.light)),t.setFont("helvetica","normal"),t.text("Generated by Digital Slate",s,290),t.text(`Page ${e} of ${U}`,D-s,290,{align:"right"});t.save(k),console.log("[DEBUG] PDF save triggered",k)}catch(E){console.error("[DEBUG] Error in exportSessionPDF:",E),alert("PDF export failed: "+E.message)}}export{et as exportSessionPDF};
